{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jo%C3%A3o/Documents/GitHub/TCC-Barbearia/Barbearia-TCC-FrontEnd/components/Auth/FormLogin/login.tsx"],"sourcesContent":["// pages/login.tsx\r\n\r\nimport { FormEvent, useEffect, useState } from \"react\";\r\nimport \"./login.css\"; // Seus estilos CSS\r\nimport { useAuth, LoginContextResult } from \"../../../contexts/AuthContext\"; // ✅ Importe LoginContextResult (se definido, senão precisaremos criar)\r\nimport Link from \"next/link\";\r\nimport { LoginCredentials } from \"../../../services/AuthAPI\"; // ✅ Importe LoginCredentials\r\n\r\nexport default function Login() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n\r\n  // ✅ Renomeado `error` para `serverError` para clareza\r\n  const [serverError, setServerError] = useState<string | null>(null);\r\n\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  // ✅ NOVO ESTADO: Para erros de validação de cada campo no frontend\r\n  const [validationErrors, setValidationErrors] = useState<{ [key: string]: string }>({});\r\n\r\n  const { login, registredEmail, clearRegistredEmail } = useAuth();\r\n\r\n  useEffect(() => {\r\n    // console.log(registredEmail); // Manter para debug, mas pode remover no final\r\n    if (registredEmail) {\r\n      setEmail(registredEmail);\r\n      clearRegistredEmail(); // Limpa o email registrado após usá-lo\r\n    }\r\n  }, [clearRegistredEmail, registredEmail]); // Dependências do useEffect\r\n\r\n  // ✅ NOVO: Função de validação local do formulário\r\n  const validateForm = (): boolean => {\r\n    const errors: { [key: string]: string } = {};\r\n\r\n    if (!email.trim()) {\r\n      errors.email = \"O e-mail é obrigatório.\";\r\n    } else if (!/\\S+@\\S+\\.\\S+/.test(email.trim())) {\r\n      // Validação de formato de e-mail simples\r\n      errors.email = \"Formato de e-mail inválido.\";\r\n    }\r\n\r\n    if (!password.trim()) {\r\n      errors.password = \"A senha é obrigatória.\";\r\n    }\r\n    // Adicione outras validações de senha se houver (ex: minLength, complexidade)\r\n    // } else if (password.trim().length < 6) {\r\n    //   errors.password = \"A senha deve ter no mínimo 6 caracteres.\";\r\n    // }\r\n\r\n    setValidationErrors(errors); // Atualiza o estado de erros de validação\r\n    return Object.keys(errors).length === 0; // Retorna true se não houver erros\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n\r\n    // Limpa o erro do campo atual ao digitar\r\n    setValidationErrors((prevErrors) => {\r\n      const newErrors = { ...prevErrors };\r\n      delete newErrors[name];\r\n      return newErrors;\r\n    });\r\n\r\n    // Limpa a mensagem de erro do servidor ao digitar em qualquer campo\r\n    setServerError(null);\r\n\r\n    // Atualiza o estado do campo correspondente\r\n    if (name === \"email\") {\r\n      setEmail(value);\r\n    } else if (name === \"password\") {\r\n      setPassword(value);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: FormEvent) => {\r\n    e.preventDefault(); // Previne o comportamento padrão do formulário\r\n\r\n    setServerError(null); // Limpa erros anteriores do servidor\r\n    setIsSubmitting(true); // Ativa o estado de submissão\r\n    setValidationErrors({}); // Limpa erros de validação anteriores\r\n\r\n    // ✅ 1. Executa a validação do formulário no frontend\r\n    const isValid = validateForm();\r\n    if (!isValid) {\r\n      setIsSubmitting(false); // Desativa o estado de submissão se houver erros de validação\r\n      return; // Para aqui se houver erros de validação\r\n    }\r\n\r\n    try {\r\n      // ✅ Passa um objeto de credenciais para a função login\r\n      const credentials: LoginCredentials = { email: email.trim(), password: password.trim() };\r\n      const result: LoginContextResult = await login(credentials); // Assumindo que 'login' do contexto retorna LoginContextResult\r\n\r\n      if (!result.success) {\r\n        // Se a função `login` do contexto indicou um erro do servidor\r\n        setServerError(result.message);\r\n      }\r\n      // Se `result.success` for `true`, o redirecionamento já ocorreu dentro do contexto.\r\n    } catch (err: unknown) {\r\n      // ✅ Tipado como unknown\r\n      console.error(\"Erro final no handleSubmit do LoginPage:\", err);\r\n      let errorMessage = \"Falha ao fazer login. Verifique seu e-mail e senha.\"; // Mensagem padrão para erros inesperados\r\n      if (err instanceof Error) {\r\n        errorMessage = err.message;\r\n      } else if (typeof err === \"string\") {\r\n        errorMessage = err;\r\n      }\r\n      setServerError(errorMessage);\r\n    } finally {\r\n      setIsSubmitting(false); // ✅ Desativa o estado de submissão no final\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login-box\">\r\n      <div className=\"container-login\">\r\n        <h1 className=\"login-title\">Entrar</h1>\r\n        {/* ✅ O FORMULÁRIO DEVE TER O onSubmit */}\r\n        <form className=\"form-login\" onSubmit={handleSubmit}>\r\n          {/* Campo Email */}\r\n          <div className=\"style\">\r\n            <label htmlFor=\"email\">Email</label>\r\n            <input\r\n              id=\"email\"\r\n              type=\"email\"\r\n              name=\"email\" // ✅ Adicionar o atributo name\r\n              value={email}\r\n              onChange={handleChange}\r\n              className={validationErrors.email ? \"input-error\" : \"\"} // Adiciona classe para estilizar\r\n            />\r\n            {/* ✅ Exibir o erro correto para o campo 'email' */}\r\n            {validationErrors.email && (\r\n              <p style={{ color: \"red\" }} className=\"validation-error-message\">\r\n                {validationErrors.email}\r\n              </p>\r\n            )}\r\n          </div>\r\n\r\n          {/* Campo Senha */}\r\n          <div className=\"style\">\r\n            <label htmlFor=\"password\">Senha</label>\r\n            <input\r\n              id=\"password\"\r\n              type=\"password\"\r\n              name=\"password\" // ✅ Adicionar o atributo name\r\n              value={password}\r\n              onChange={handleChange}\r\n              className={validationErrors.password ? \"input-error\" : \"\"}\r\n            />\r\n            {/* ✅ Exibir o erro correto para o campo 'password' */}\r\n            {validationErrors.password && (\r\n              <p style={{ color: \"red\" }} className=\"validation-error-message\">\r\n                {validationErrors.password}\r\n              </p>\r\n            )}\r\n\r\n            <Link style={{ padding: \"5px\", width: \"170px\", alignSelf: \"end\", textAlign: \"end\" }} href={\"../forgot-password\"}>\r\n              esqueci minha senha!\r\n            </Link>\r\n          </div>\r\n\r\n          {/* Botão de Login (DENTRO do formulário) */}\r\n\r\n          {/* Área para exibir mensagens de erro do SERVIDOR */}\r\n          {serverError && (\r\n            <p className=\"server-error-message\" style={{ color: \"red\", marginTop: \"1rem\" }}>\r\n              {serverError}\r\n            </p>\r\n          )}\r\n\r\n          <p className=\"sem-conta\">\r\n            Não tem uma conta?{\" \"}\r\n            <Link className=\"link-cadastrar\" href=\"/register\">\r\n              Cadastre-se\r\n            </Link>\r\n          </p>\r\n        </form>\r\n      </div>\r\n      <button className=\"submit-button-login\" type=\"submit\" disabled={isSubmitting} onClick={handleSubmit}>\r\n        {isSubmitting ? \"Entrando...\" : \"Entrar\"}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 290, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jo%C3%A3o/Documents/GitHub/TCC-Barbearia/Barbearia-TCC-FrontEnd/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\"; // Ajuste o caminho se necessário\r\n\r\nimport Login from \"../../../../components/Auth/FormLogin/login\";\r\n\r\nexport default function LoginPage() {\r\n  return (\r\n    <div style={{ maxWidth: \"400px\", margin: \"auto\", paddingTop: \"50px\", paddingBottom: \"50px\" }}>\r\n      <Login />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAKA;AALA;;;AAOe,SAAS;IACtB,qBACE,8OAAC;QAAI,OAAO;YAAE,UAAU;YAAS,QAAQ;YAAQ,YAAY;YAAQ,eAAe;QAAO;kBACzF,cAAA,8OAAC,oJAAK;;;;;;;;;;AAGZ","debugId":null}}]
}